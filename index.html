<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Location Tracker</title>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // üîπ Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyDiKFX20cKkhHU0OkAVw6Dv45lWUT7oz5Y",
            authDomain: "lucation1t.firebaseapp.com",
            projectId: "lucation1t",
            storageBucket: "lucation1t.firebasestorage.app",
            messagingSenderId: "36109638018",
            appId: "1:36109638018:web:04733eb656519311e7979b",
            measurementId: "G-9BK23ZBMT6"
        };

        // üîπ Firebase Initializing
        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app); // Make db accessible globally
    </script>
</head>
<body>
    <h1>üìç ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞</h1>
    <button onclick="saveUserData()">üìç ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    
    <script>
        // üîπ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ì Firestore-‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function saveUserData() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (position) => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    const userAgent = navigator.userAgent;

                    // üîπ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶á‡¶™‡¶ø ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipResponse.json();
                    const ipAddress = ipData.ip;

                    try {
                        // üîπ Firestore-‡¶è ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£
                        await addDoc(collection(window.db, "users_data"), {
                            latitude: latitude,
                            longitude: longitude,
                            ip_address: ipAddress,
                            device_info: userAgent,
                            timestamp: serverTimestamp()
                        });
                        alert("‚úÖ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                    } catch (error) {
                        console.error("‚ùå ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:", error);
                    }
                });
            } else {
                alert("‚ùå ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ Geolocation ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ!");
            }
        }
    </script>
</body>
</html>
